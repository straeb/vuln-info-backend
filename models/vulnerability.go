package models

import (
	"time"
)

type Vulnerability struct {
	CVEId       string    `json:"cve" form:"cve" gorm:"primary_key" `
	Description string    `json:"description"`
	CWE         string    `json:"cwe"`
	CPEs        []Cpe     `json:"-"  gorm:"many2many:vulnerabilities_cpes;constraint:OnUpdate:CASCADE,OnDelete:CASCADE;"`
	CreatedAt   time.Time `json:"-" `
}

type CreateVulnerabilityInput struct {
	CVEId       string `json:"cve"       binding:"required,cve"`
	Description string `json:"description"`
	CWE         string `json:"cwe"`
	CPEs        []Cpe  `json:"cpes" `
}
type UpdateVulnerabilityInput struct {
	Description string `json:"description"  binding:"required"`
	CWE         string `json:"cwe"`
	CPEs        []Cpe  `json:"cpes" `
}

func (c CreateVulnerabilityInput) TurnToVulnerability() *Vulnerability {
	return &Vulnerability{
		CVEId:       c.CVEId,
		Description: c.Description,
		CWE:         c.CWE,
		CPEs:        c.CPEs,
	}

}
